ノイズチャンネルは疑似乱数の1ビットノイズを異なる16の周波数で生成する

ノイズチャンネルは以下のユニットから構成されている

- エンベロープ
- タイマー
- シフトレジスタ
- 長さカウンタ

```text
   Timer --> Shift Register   Length Counter
                   |                |
                   v                v
Envelope -------> Gate ----------> Gate --> (to mixer)
```

# レジスタ

## $400C メイン (write)
--lc vvvv

l: 長さカウンタのhaltフラグ \
c: ボリューム/エンベロープフラグ \
v: ボリューム/エンベロープ Divider Period

## $400E タイマー周期 (write)
M--- PPPP

M: モードフラグ
P: 下記のテーブルの対応するエントリーにタイマーの周期が決まる

```text
Rate  $0 $1  $2  $3  $4  $5   $6   $7   $8   $9   $A   $B   $C    $D    $E    $F
      --------------------------------------------------------------------------
NTSC   4, 8, 16, 32, 64, 96, 128, 160, 202, 254, 380, 508, 762, 1016, 2034, 4068 (2046 in old)
PAL    4, 8, 14, 30, 60, 88, 118, 148, 188, 236, 354, 472, 708,  944, 1890, 3778
```

これらの周期はシフトレジスタのクロックの間に、どれだけのCPUサイクルが経過するかを決める

## $400F 長さカウンタ＆エンベロープリスタート (write)

llll l---

l: 長さカウンタのロード値


# 動作

Shift register は15bit幅である

タイマーがシフトレジスタをクロックする時、以下のことが順に起こる

1. bit0とbit6(Mode フラグがセットされていれば bit1)の排他がフィードバックとして計算される
2. シフトレジスタは右に1ビット分シフトされる
3. Bit14(一番左のビット)が1で計算したフィードバックにセットされる

これは結果として疑似ランダムなビットの流れを生む

Mode フラグがクリアであれば32767ステップ長、セットされていればランダムで93か31ステップ長である(93か31は、32767ステップのどこで Mode フラグがセットされてたかによる)

ミキサは以下の状況を除き、現在のエンベロープのボリュームを受け取る

1. シフトレジスタの bit0 がセットされている
2. 長さカウンタが0である

いずれかの条件を満たす時、チャンネルの出力は0となる

ミキサ内では DMCレベルはノイズレベルに対して明らかな影響を与える

起動時、シフトレジスタは1でロードされる







